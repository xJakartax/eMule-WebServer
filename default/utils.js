var bytesToSize=function(a){if(0==a)return'0 Byte';var b=Math.floor(Math.log(a)/6.931471805599453);return(a/Math.pow(1024,b)).toPrecision(3)+' '+['Bytes','KB','MB','GB','TB','PB','EB','ZB','YB'][b]},isDesktop=function(){var a=$(window).width();return!!(768<a)};$.fn.ajaxForm=function(a,b){b='function'==typeof a?a:b;var c=$.extend({method:this.attr('method'),action:this.attr('action'),dataType:'json'},a);return $.ajax({type:c.method,url:c.action,data:this.serialize(),success:function(a){'json'===c.dataType&&(a=JSON.parse(a)),_.isFunction(b)&&b.call(this,a)}}),this},$.fn.jQMobileAjaxSubmit=function(a){var b=$.extend({method:this.attr('method'),action:this.attr('action'),dest:'div[data-role="content"]'},a);return b.$dest=$(b.dest),$.ajax({type:b.method,url:b.action,data:this.serialize(),beforeSend:function(){$.mobile.loading('show')},success:function(a){b.$dest.html(a).enhanceWithin().trigger('pagecreate'),$.mobile.loading('hide')}}),this},$.fn.jQMobileAjaxLink=function(a){var b=$.extend({type:'get',href:this.attr('href'),dest:'div[data-role="content"]',loaderText:'',loaderTextVisible:!1},a);return b.$dest=$(b.dest),$.ajax({type:b.type,url:b.href,beforeSend:function(){$.mobile.loading('show',{text:b.loaderText,textVisible:b.loaderTextVisible})},success:function(a){b.$dest.html(a).enhanceWithin().trigger('pagecreate'),$.mobile.loading('hide')}}),this};var notify={initPopup:function(a){return a=a||{},_.defaults(a,{class:'notify ui-content',"data-role":'popup'}),this.$el?this.$el.attr(a):(this.$el=$('<div/>',a).appendTo('body'),this.$el.popup({afteropen:_.bind(function(){this.opened=!0},this),afterclose:_.bind(function(){this.opened=!1,this.closedPrevPopup&&this.closedPrevPopup.call()},this)})),this.$el},createPopup:function(a,b,c){return b=b||{},this.initPopup(c),_.defaults(b,{transition:'slidedown',positionTo:'#header',corners:!1,history:!1,theme:$('div#main').attr('data-theme')||'a'}),this.$el.html(a),this.$el.popup('option',b),this.closedPrevPopup=null,this.$el},open:function(a,b,c){b=b||{},_.defaults(b,{delay:mm.settings.notifyDelay});var d=_.bind(function(){b.delay&&setTimeout(_.bind(function(){this.$el.popup('close')},this),b.delay),_.omit(b,'delay'),this.createPopup(a,b,c).popup('open')},this);this.opened?(this.closedPrevPopup=_.bind(function(){d()},this),this.$el.popup('close')):d()},message:function(a,b){this.open('<p><i class="fa fa-info-circle"></i> '+a+'</p>',b,{class:'message info'})},error:function(a,b){this.open('<p><i class="fa fa-exclamation-triangle"></i>'+a+'</p>',b,{class:'message error'})}},createCookie=function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+1e3*(60*(60*(24*c))));var e='; expires='+d.toGMTString()}else var e='';document.cookie=a+'='+b+e+'; path=/'},readCookie=function(a){for(var b,d=a+'=',e=document.cookie.split(';'),f=0;f<e.length;f++){for(b=e[f];' '==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(d))return b.substring(d.length,b.length)}return null},eraseCookie=function(a){createCookie(a,'',-1)};(function(){if('indexedDB'in window){var a=idb.open('mobileMule',1,function(a){switch(a.oldVersion){case 0:a.createObjectStore('downloads',{keyPath:'hash'});}}),b={get(b){return a.then(function(a){return a.transaction('downloads').objectStore('downloads').get(b)})},set(b){return a.then(function(a){const c=a.transaction('downloads','readwrite');return c.objectStore('downloads').put(b),c.complete})},add(a){return this.set(a)},delete(b){return a.then(function(a){const c=a.transaction('downloads','readwrite');return c.objectStore('downloads').delete(b),c.complete})},clear(){return a.then(function(a){const b=a.transaction('downloads','readwrite');return b.objectStore('downloads').clear(),b.complete})},getAll(){return a.then(function(a){var b=a.transaction('downloads','readonly'),c=b.objectStore('downloads');return c.getAll()})},addCurrentDownloads(){var a=this;$.getJSON('downloads-ajax.php',function(b){b.downloads.list.forEach(function(b){a.add(_.pick(b,'hash','name','size'))})})}};window.idbDownloads=b}})();